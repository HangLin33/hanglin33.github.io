<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Global Journey - Hang Lin</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsvectormap/dist/css/jsvectormap.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/jsvectormap"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsvectormap/dist/maps/world.js"></script>

    <style>
        :root {
            --apple-bg: #f5f5f7;
            --text-main: #1d1d1f;
            --map-base: #e5e5e7; /* 没去过的国家：浅灰 */
        }

        body { background-color: var(--apple-bg); font-family: -apple-system, sans-serif; }

        .map-wrapper {
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
            background: #ffffff;
            border-radius: 24px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.05);
        }

        #world-map { width: 100%; height: 650px; }

        /* 修复后的提示框样式 */
        .jvm-tooltip {
            background: rgba(29, 29, 31, 0.9) !important;
            backdrop-filter: blur(8px);
            border: none !important;
            border-radius: 12px !important;
            padding: 10px 15px !important;
            font-size: 14px !important;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

<div class="map-wrapper">
    <div style="padding: 20px 40px;">
        <h2 style="font-weight: 800; color: var(--text-main);">Global Journey</h2>
        <p style="color: #86868b;">Footprints across the continents. Click a country to explore.</p>
    </div>
    
    <div id="world-map"></div>
</div>

<script>
    // 1. 定义你去过的国家列表 (ISO代码)
    // 领土修复：将 CN 与 TW 逻辑关联
    const visitedCodes = ["GB", "FR", "DE", "IT", "CH", "NO", "US", "MV", "CN", "TW", "TH", "MY", "SG", "ID", "AU", "AE", "TR"];

    // 2. 映射跳转链接 (台湾点击也跳转到中国页面或指定页面)
    const travelLinks = {
        "GB": "journey/uk.html", "FR": "journey/france.html", "DE": "journey/germany.html",
        "IT": "journey/italy.html", "CH": "journey/switzerland.html", "NO": "journey/norway.html",
        "US": "journey/usa.html", "MV": "journey/maldives.html", "CN": "journey/china.html",
        "TW": "journey/china.html", // 逻辑关联
        "TH": "journey/thailand.html", "MY": "journey/malaysia.html", "SG": "journey/singapore.html",
        "ID": "journey/indonesia.html", "AU": "journey/australia.html", "AE": "journey/uae.html", "TR": "journey/turkey.html"
    };

    // 3. 莫兰迪低饱和度配色方案 (更高级，不刺眼)
    const colorPalette = ["#84a59d", "#9b89b3", "#778da9", "#a5a58d", "#6b705c", "#8d99ae", "#b7b7a4"];

    // 为去过的每个国家分配一个颜色（或者同系列不同色）
    const regionData = {};
    visitedCodes.forEach((code, index) => {
        regionData[code] = colorPalette[index % colorPalette.length];
    });

    const map = new jsVectorMap({
        selector: "#world-map",
        map: "world",
        draggable: true,
        zoomButtons: false,
        
        regionStyle: {
            initial: { fill: '#ececec', stroke: '#fff', strokeWidth: 0.8 },
            hover: { fillOpacity: 0.7, cursor: 'pointer' }
        },

        // 设置国家颜色
        series: {
            regions: [{
                values: regionData,
                attribute: 'fill'
            }]
        },

        // 交互逻辑
        onRegionClick: function(event, code) {
            // 修复：点击台湾或中国大陆执行相同逻辑
            let targetCode = (code === "TW") ? "CN" : code;
            if (travelLinks[targetCode]) {
                window.location.href = travelLinks[targetCode];
            }
        },

        // 修复国家名字显示逻辑
        onRegionTooltipShow(event, tooltip, code) {
            let name = tooltip.text();
            
            // 修正台湾在提示框中的显示
            if (code === "TW" || code === "CN") {
                name = "China";
            }

            if (visitedCodes.includes(code)) {
                tooltip.text(`<div style="text-align:center;"><b>${name}</b><br><span style="font-size:12px; color:#81ecec;">Click to view stories</span></div>`, true);
            } else {
                tooltip.text(`<b>${name}</b>`);
            }
        }
    });
</script>

</body>
</html>
